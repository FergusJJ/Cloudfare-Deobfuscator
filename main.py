import re
#Update the array with your current cf versions 
array = 'OeiBw{getUTCSeconds{;path=/{style{cf_chl_rc_i{WUIGG{ulFLj{GceCe{JSON.parse{compressToBase64{tkRMx{KWFBL{Xvuna{PoQJP{cf-spinner-please-wait{ZatHx{VMNdw{BpMmW{yyOJU{gcWTn{alert{tlCXh{xcGfc{zaVAH{iQMDm{string{lVoTS{navigator{bHutg{application/x-www-form-urlencoded{GLKvN{oEGGH{QchIz{0000{QOQuL{oLQkb{[[[ERROR]]]:{addEventListener{protocol{dGSiH{UorHU{MBUgm{xRdtG{EbPGS{src{XxWFB{uIllw{[object Array]{/cdn-cgi/challenge-platform/{hasOwnProperty{cf-please-wait{_cf_chl_ctx{MCzyy{jzhMN{Rwrra{3|4|2|0|1{tfIPY{cf_chl_prog{nDjNF{type{charCodeAt{aOHfc{bAotz{toLowerCase{valueOf{uzOFr{onerror{location-mismatch-warning{NJyjk{eEZDw{sendRequest{wpRQm{awsJC{rnpPm{CMrbX{getUTCMinutes{uyWLG{bbfip{THzJU{immTh{CnDat{_cf_chl_hload{PKavR{JCiBy{cRq{cNounce{rYgGA{QQTbi{cnbYX{number{tZtTu{wlbDF{ismlG{IFeym{KDGcq{setTime{qaoAw{DWIEk{EWAvc{OGjHY{kFkLB{lNGtV{zltYG{LEJiv{Line: {QdzZK{script{replace{2|4|5|0|3|1{Date{challenge-form{nIyeF{0|3|4|1|2{JSON{wQXwd{BqNTUvIzdr504a2XtYckbHoVSGi1u6ng9Csw3FOZDMjpP8eR7fhyEJLWxmAlQK{gaOew{eYIwR{WimRr{pfEmn{cFPWv{cfEXY{gQrKV{RZhSH{readyState{MNsgt{gMZay{NeEWM{ZirlK{WJAHZ{ijiVK{iMBJW{cf_chl_{expires={script error{WWGQF{ncaGR{Iiefd{function{_cf_chl_done_ran{TzPfp{TVdFA{oegZz{<div class="cf-content"><p style="background-color: #de5052; border-color: #521010; color: #fff;" class="cf-alert cf-alert-error">This web property is not accessible via this address.</p></div>{kgMPO{log{QdyKj{pyWLR{Nzdlg{SAAWf{oNgzo{split{aHWih{BkePl{cType{charAt{KxlNG{OUEeD{NxJtJ{Zrmkp{LKHIq{ActiveXObject{<p class="cf-alert cf-alert-error">This is taking longer than expected, please reload the page.</p>{pMvzg{CF-Challenge{POST{hbKiZ{Error object: {reload{GwgqQ{yjs-content{qUqkh{VfRfH{hhzat{head{hSCfF{ilIeZ{kaJjL{moOne{LaAfl{indexOf{getElementsByTagName{no-cookie-warning{length{fromCharCode{onreadystatechange{location{pow{rSsdE{ontimeout{prototype{display{fJFRk{naiax{atob{==={=; Max-Age=-99999999;{GOOrt{0123456789abcdef{PQcRe{readystatechange{none{boolean{SCpPx{getElementById{MXDlc{KPHSC{send{dWugn{llUaq{setRequestHeader{sIHOY{BJBkY{getUTCMonth{GbGdP{substring{ZxPKB{Function{FsKnE{6mBkyZ5ftiWxPd3s4OaTVcueIE7UHwK09q2$Cp8YGvbDNlrQ-gS+hj1FJMXzoAnRL{ieEoE{FVCnC{yMllF{Column: {timeout{EfKvY{OPktW{UnEkx{sAMLx{gjmNN{wJhyI{Microsoft.XMLHTTP{rxTtT{eqlgI{push{apply{SLkIX{Sptyp{OHXxC{wvSzc{object{open{toString{fTSOb{YqWzQ{kpRDx{kfuSh{kGnyA{JSON.stringify{cvId{syhRg{status{XMLHttpRequest{lhVuS{join{DNnsP{ZrxRc{pnLPG{qNhfD{dThqf{dZdGT{call{chReq{GdXSu{gUikM{lastIndex{QTUTD{toUTCString{tfZNy{wkPTK{hkuyt{isNaN{gkyuQ{https://hcaptcha.com/1/api.js?render=explicit&recaptchacompat=off&onload=_cf_chl_hload{eByEz{ptPTe{RFZNe{waZFP{WAJvS{YFcEX{vweJb{Script Error: See Browser Console for Detail{XrIwA{kzapQ{DSzIR{_cf_chl_opt{/0.3130017569913983:1608283294:54ada8b9cdb3d2b6ae87b7b333893ce3856328f0985385343a70142acc657163/{XtFri{attachEvent{vXAxw{aemLi{String{PFZBj{YWsHz{KvKEX{iOwNW{generate/ov{KtwYi{bADEq{console{slice{decompressFromBase64{uIQAI{DOMContentLoaded{chLog{block{chCAS{zgJoK{sDisN{EsrJe{text/javascript{cRay{GzUOp{yVaST{miWdp{Message: {stringify{APBOC{agzXA{%2b{parse{min{null{toJSON{IqJzG{uUWDK{cf-content{XgDQn{compressToEncodedURIComponent{TTLDK{innerHTML{PdeES{KeebE{getTime{hostname{oabEQ{dWSEd{GzDSH{parseInt{OdKlq{gVRsI{BFqnj{forEach{mEjAt{tiFhl{TpXsD{nVUvn{TPBmE{SGdWN{SHA256{3|1|2|0|4{getUTCDate{createElement{ENfIa{UuWRS{NkjPR{ - {jZxbH{cookie{pZonB{rWYvt{wNSIb{PANFT{0|2|5|1|4|3{Content-type{test{wfDrp{XDPfF{JlpHS{SZJTp{MpMHR{xLGvW{MIZPz{document{xjpDe{FTWpX{HuNno{appendChild{getUTCHours{hrUUw{This browser is not supported.{cHash{wMUAt{JyJtk{ZAxlu{rHyrb{1|5|0|2|4|3{cookieEnabled{yztWx{puqzt{responseText{Math{href{URL: {zZehw{aOgRQ{bHsMK{getUTCFullYear{MfEpo{cDvCx{wiQyh{rMtGy{bQeaT{BOdPY{aEUxw{HCIHo{setTimeout{NtACy{ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/={<div class="cf-content"><p style="background-color: #de5052; border-color: #521010; color: #fff;" class="cf-alert cf-alert-error">&#35813;&#32593;&#31449;&#36164;&#28304;&#26080;&#27861;&#36890;&#36807;&#27492;&#22320;&#22336;&#35775;&#38382;&#12290;</p></div>{chC{uifrh{_cf_chl_hloaded{JEuOQ{_cf_chl_enter{1|3|4|2|0|5{OExwG{adrRz{wutwt{decompressFromEncodedURIComponent{euzbO{Pazbg'.split(sep='{')

pattern = '0x\w{1,3}'
hex_reg = re.compile(pattern)
pattern_2 = "b\('0x\w{1,3}'\)"
whole_reg = re.compile(pattern_2)

with open('cf_in.txt','r') as src:
    read = src.read()
    out = [array[int(numeric_string,0)] for numeric_string in (hex_reg.findall(read))]
    src.close()  

print(out)

with open('js_out.js','w+') as JS_OUT:
    with open('cf_in.txt','r') as src_2:
        new_file = set()
        read_2 = src_2.readlines()
        i=0
        new_list = []
    #we need to print out the lines and get the first match with .search then increment the array[index]
    #from there we can run the function again, if ther is another match we do the same, if we get none we go to the next line
        for line in read_2:
            matches_remaining = True
            MATCH = whole_reg.search(line)
            if bool(MATCH) == True:
                line = line.replace(MATCH.group(0),'"'+out[i]+'"')
                while matches_remaining == True:
                    MATCH = whole_reg.search(line)
                    if bool(MATCH) == True:
                        line = line.replace(MATCH.group(0),'"'+out[i]+'"')
                        i+=1
                    if bool(MATCH) == False:
                        print('next line')
                        i+=1
                        matches_remaining = False
            else:
                
                print('searching...')
                matches_remaining = False
            JS_OUT.write(line)
JS_OUT.close()
src_2.close()